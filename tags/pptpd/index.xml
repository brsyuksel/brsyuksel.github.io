<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
      <title>Pptpd on barış yüksel </title>
      <generator uri="https://hugo.spf13.com">Hugo</generator>
    <link>http://brsyuksel.github.io/tags/pptpd/index.xml/</link>
    <language>tr_TR</language>
    
    
    <updated>Fri, 01 Aug 2014 18:54:19 &#43;0200</updated>
    
    <item>
      <title>pptpd ile pptp vpn server kurulumu</title>
      <link>http://brsyuksel.github.io/post/pptp/</link>
      <pubDate>Fri, 01 Aug 2014 18:54:19 &#43;0200</pubDate>
      
      <guid>http://brsyuksel.github.io/post/pptp/</guid>
      <description>

&lt;p&gt;dns çözümlerinin yetersiz kaldığı anlarda(!) vpn çözümlerine başvuruyoruz. bu dökümanda düşük bir maliyetle edinebileceğiniz vps&amp;rsquo;inizi nasıl size özel bir pptp vpn-server&amp;rsquo;a çevirebileceğinizi anlatmaya çalışacağım. ücretsiz vpn hizmetlerinin yetersiz kaldığı anlarda(!) hızlı bir çözüm olacaktır. server kurulumu fedora 19, client fedora 20 olsa da bir çok dağıtım için yapılandırma benzer olacaktır.&lt;/p&gt;

&lt;p&gt;başlamadan bahsedeyim alternatif olarak openVPN gibi çözümler mevcut ancak kaynak kullanımı, hız-performans gibi konulardan ötürü ben pptp&amp;rsquo;yi tercih ettim. yine de farklı yetenekli olan openVPN&amp;rsquo;i deneyebilirsiniz.&lt;/p&gt;

&lt;h1 id=&#34;toc_0&#34;&gt;server&lt;/h1&gt;

&lt;p&gt;pptpd paketini kurun.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;yum install pptpd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ilk olarak pptpd ayarlarında bir kaç değişiklik yapmanız gerekiyor. &lt;code&gt;/etc/pptpd.conf&lt;/code&gt; dosyasında şu düzenlemeleri yapın.&lt;/p&gt;

&lt;p&gt;#logwtmp
  localip 10.0.0.1
  remoteip 10.0.0.100-200&lt;/p&gt;

&lt;p&gt;logwtmp satırını disable ederek connection loglarının tutulmasını kapatmış bulunuyoruz. daha fazla yapılandırma bilgisi için &lt;code&gt;man pptpd.conf&lt;/code&gt; yazarak bilgi alabilirsiniz.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;/etc/ppp/options.pptpd&lt;/code&gt; dosyasında yine bir kaç satırlık düzenleme yapmanız gerekiyor. client&amp;rsquo;ların dns hizmeti için hangi sağlayıcının kullanılacabını belirleyin. ben alttaki örnekte google dns(!) kullandım.&lt;/p&gt;

&lt;p&gt;ms-dns 8.8.8.8
  ms-dns 8.8.4.4&lt;/p&gt;

&lt;p&gt;&lt;code&gt;/etc/ppp/chap-secrets&lt;/code&gt; dosyasında uygun formatta vpn-server&amp;rsquo;ınızın kullanıcınılarını basit bir şekilde kullanıcı adı ve şifre olarak tanımlıyorsunuz.&lt;/p&gt;

&lt;p&gt;[USERNAME] pptpd [PASSWORD] *&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[USERNAME]&lt;/em&gt; ve &lt;em&gt;[PASSWORD]&lt;/em&gt; alanlarını kendinize göre düzenleyin. eklemek istediğiniz kullanıcı varsa aynı dosyaya aynı formatta eklemeye devam edebilirsiniz.&lt;/p&gt;

&lt;p&gt;şimdi ip forwarding&amp;rsquo;i açmamız gerekiyor. geçici olarak açmak istediğiniz taktirde şu komutu kullanabilirsiniz:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sysctl net.ipv4.ip_forward=1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ancak olası bir reboot sonrası bu ayar default değer olan 0 değerini alacağından kalıcı olması için &lt;code&gt;/etc/sysctl.d/99-ip_forward.conf&lt;/code&gt; dosyasını oluşturup aynı komutu dosyaya girdi olarak bırakıyoruz&lt;/p&gt;

&lt;p&gt;net.ipv4.ip_forward=1&lt;/p&gt;

&lt;p&gt;ayarların uygulanması için tekrar sysctl&amp;rsquo;den yararlanıyoruz. aşağıdaki komut yardımcı olacaktır.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sysctl --system
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;bu noktadan sonra iptables&amp;rsquo;a bazı eklemeleri yapmamız gerekiyor. bunlar şu şekilde:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
iptables --table nat --append POSTROUTING --out-interface ppp0 -j MASQUERADE
iptables -I INPUT -s 10.0.0.0/8 -i ppp0 -j ACCEPT
iptables --append FORWARD --in-interface eth0 -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;iptables girdileri yine reboot sonrası kalıcı olmayacağından girdileri &lt;code&gt;/etc/iptables/iptables.rules&lt;/code&gt; dosyasına kaydetmek kalıcılık sağlayacaktır. aşağıdaki komut aradığınız çözüm.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;iptables-save &amp;gt; /etc/iptables/iptables.rules
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;server yapılandırmasında sona geldik. şimdi iptables servisini yeniden başlatıp ve pptpd servisini başlatıp reboot sonrası otomatik başlatma için ayarlayın.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;systemctl restart iptables.service
systemctl start pptpd.service
systemctl enable pptpd.service
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;toc_1&#34;&gt;client&lt;/h1&gt;

&lt;p&gt;bu adımda client&amp;rsquo;ımızı yapılandırıp vpn-server&amp;rsquo;ımıza bağlanacağız.&lt;/p&gt;

&lt;p&gt;client&amp;rsquo;da pptp paketine ihtiyaç duyuyoruz. pptp paketini yükleyin.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;yum install pptp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;bağlanacağımız vpn-server&amp;rsquo;ları &lt;code&gt;/etc/ppp/peers/&lt;/code&gt; klasörü altında belirli bir formatta tanımlıyoruz. bu noktada kullanacağınız vpn-server&amp;rsquo;ı tanımladığınız dosya adı önemli çünkü ilerde bağlantı sağlanırken kullanılan komutta bu dosya adını parametre olarak vereceğiz.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;/etc/ppp/peers/ozelvpn&lt;/code&gt; dosyası şu şekilde olabilir.&lt;/p&gt;

&lt;p&gt;pty &amp;ldquo;pptp [SERVERIP] &amp;ndash;nolaunchpppd&amp;rdquo;
  name [USERNAME]
  password [PASSWORD]
  remotename PPTP
  require-mppe-128&lt;/p&gt;

&lt;p&gt;örnekteki &lt;em&gt;[SERVERIP]&lt;/em&gt; yerine VPS&amp;rsquo;inizin IP adresini yazmalısınız. &lt;em&gt;[USERNAME]&lt;/em&gt; ve &lt;em&gt;[PASSWORD]&lt;/em&gt; alanlarına server&amp;rsquo;da &lt;code&gt;/etc/ppp/chap-secrets&lt;/code&gt; dosyasında tanımladığınız uygun kullanıcının bilgilerini girmeniz gerekiyor.&lt;/p&gt;

&lt;p&gt;şimdi vpn-serverımızla bağlantıyı sağlayalım.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;pppd call ozelvpn
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;bu komutu çalıştırdıktan sonra &lt;strong&gt;ozelvpn&lt;/strong&gt; olarak tanımladığınız vpn&amp;rsquo;inize bağlanmış olacaksınız ancak tunnelling hala gerçekleşmiyor. vpn ile olan bağlantınızı kontrol etmek için aşağıdaki komutu kullanabilirsiniz.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;tail -f /var/log/messages
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;tunnelling&amp;rsquo;i gerçekleştirmek için bir route işlemine ihtiyaç duyuyor olacaksınız. bu işlemi de şu şekilde gerçekleştirip son adımı tamamlamış olacaksınız ve artık packet&amp;rsquo;ler vpn üzerinden dolaşacak. ip adres kontrolü sağlayan sitelerden ip adresinizi &lt;a href=&#34;http://ipadresimnedir.org&#34; title=&#34;ipadresimnedir.org&#34;&gt;ipadresimnedir.org&lt;/a&gt; sitesinden ya da hiç vakit kaybetmeden özgürlüğünüzü, 21.yy dünyasında demoktratik haklarınızın engellenip engellenmediğini(!) kontrol edebilirsiniz.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;route add default dev ppp0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;route işlemi de kalıcı değildir. pppd call işleminden sonra otomatik olarak yapılmasını istiyorsanız &lt;code&gt;/etc/ppp/ip-up.local&lt;/code&gt; dosyasını oluşturup şu girdiyi bırakın:&lt;/p&gt;

&lt;p&gt;#!/bin/bash
  route add default dev ppp0&lt;/p&gt;

&lt;p&gt;daha sonra dosyayı executable yapın.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;chmod +x /etc/ppp/ip-up.local
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;bu işlemden sonra her &lt;code&gt;pppd call ozelvpn&lt;/code&gt; komutundan sonra route işlemi gerçekleştirilmiş olacak.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>